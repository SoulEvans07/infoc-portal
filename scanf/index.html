<!DOCTYPE html>
<html lang="hu">

<head>
<meta charset="utf-8">
<title>TEST InfoC :: Scanf problémák</title>
<meta property="og:title" content="TEST InfoC :: Scanf problémák">
<meta property="og:image" content="/modulz/logo.png">
<meta property="og:description" content="A karakterek és a sorvége jel kezelése a scanf() függvénynél.">
<meta property="og:site_name" content="InfoC – Programozás alapjai I.">
<meta name="description" content="A karakterek és a sorvége jel kezelése a scanf() függvénynél.">
<meta name="robots" content="noarchive">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="../modulz/favicon.ico" id="faviconhref">
<link rel="apple-touch-icon" href="../modulz/logo_touch.png">
<link rel="image_src" href="../modulz/logo.png"> 
<link rel="stylesheet" href="../modulz/alap-infoc.css@v101.css">
<link rel="stylesheet" href="../modulz/style/localfonts.css@v101.css">
<script>var infoc = { onloads: [] };</script>
<script src="../modulz/site.js@v101"></script>
</head>

<body class=" doksi-formatum" data-version="101"
    data-halozati-hiba="Hálózati hiba a kérés teljesítése közben."
    data-tul-nagy-keres="A fájl túl nagy!"
    data-biztos-navigal="Biztos el szeretnél navigálni? A nem mentett változások elvesznek."
    data-ird-be-a-keresoszot="Írd be a keresőszót!"
    data-vissza="Vissza">

<div class="bodycontent">

<nav class="menubg clearfix">
<div class="shaper">
<div id="menu" class="menu menu-font-size">
<a id="menu-nyito" class="menu-nyito"  role="button"><i class="hamburger"></i></a>
<div class="menu-brand"><a href="../index/index.html">InfoC</a></div>
<div id="menu-elemek" class="menu-elemek">
<ul>
<li class="almenu "><a>Infó</a>
<ul>
<li><a  href="../index/index.html">Kezdőlap</a>
<li><a  href="../elerhetoseg/index.html">Elérhetőség</a>
</ul>

<li class="almenu "><a>Tananyag</a>
<ul>
<li class="almenu "><a>Előadás</a>
<ul>
<li><a  href="../ea01/index.html">1. hét: típusok, változók, vezérlés</a>
<li><a  href="../ea02/index.html">2. hét: nevezetes algoritmusok, tömbök</a>
<li><a  href="../ea03/index.html">3. hét: függvények, struktúrák</a>
<li><a  href="../ea04/index.html">4. hét: pointerek, sztringek</a>
<li><a  href="../ea05/index.html">5. hét: rendezések, rekurzió</a>
<li><a  href="../ea06/index.html">6. hét: operátorok, számábrázolás</a>
<li><a  href="../ea07/index.html">7. hét: dinamikus memóriakezelés</a>
<li><a  href="../ea08/index.html">8. hét: fájlkezelés, modulok</a>
<li><a  href="../ea10/index.html">10. hét: láncolt listák</a>
<li><a  href="../ea11/index.html">11. hét: bináris fák</a>
<li><a  href="../ea12/index.html">12. hét: állapotgépek, reguláris kifejezések</a>
<li><a  href="../ea13/index.html">13. hét: generikus algoritmusok, visszalépő keresés</a>
<li><a  href="../ea14/index.html">14. hét: összefoglalás</a>
</ul>

<li class="almenu "><a>Labor</a>
<ul>
<li><a  href="../lab01/index.html">1. hét: parancssor, ZIP</a>
<li><a  href="../lab02/index.html">2. hét: egyszerű programok</a>
<li><a  href="../lab03/index.html">3. hét: tömbök, nevezetes algoritmusok</a>
<li><a  href="../lab04/index.html">4. hét: struktúrák és függvények</a>
<li><a  href="../lab06/index.html">6. hét: pointerek, sztringek</a>
<li><a  href="../lab07/index.html">7. hét: rekurzió</a>
<li><a  href="../lab08/index.html">8. hét: dinamikus tömbök I.</a>
<li><a  href="../lab09/index.html">9. hét: dinamikus tömbök II.</a>
<li><a  href="../lab10/index.html">10. hét: láncolt listák</a>
<li><a  href="../lab11/index.html">11. hét: bináris fák</a>
<li><a  href="../lab12/index.html">12. hét: gyakorlás NZH-ra</a>
<li><a  href="../lab13/index.html">13. hét: állapotgépek</a>
<li><a  href="../lab14/index.html">14. hét: labirintus játék</a>
</ul>

<li class="almenu "><a>Gyakorlat</a>
<ul>
<li><a  href="../gy01/index.html">1. hét: adatmodellezés, algoritmusok</a>
<li><a  href="../gy02/index.html">2. hét: tanult algoritmusok</a>
<li><a  href="../gy03/index.html">3. hét: egyszerű programok</a>
<li><a  href="../gy04/index.html">4. hét: tételek és tömbök</a>
<li><a  href="../gy05/index.html">5. hét: származtatott típusok</a>
<li><a  href="../gy06/index.html">6. hét: karakterek, számrendszerek</a>
<li><a  href="../gy07/index.html">7. hét: pointerek használata</a>
<li><a  href="../gy08/index.html">8. hét: rekurzió</a>
<li><a  href="../gy09/index.html">9. hét: dinamikus tömbök</a>
<li><a  href="../gy10/index.html">10. hét: láncolt listák</a>
<li><a  href="../gy12/index.html">12. hét: bináris fák</a>
<li><a  href="../gy13/index.html">13. hét: állapotgépek</a>
<li><a  href="../gy14/index.html">14. hét: generikus algoritmusok</a>
</ul>

<li class="almenu "><a>Példatár</a>
<ul>
<li><a  href="../f01/index.html">1. hét: egyszerű programok</a>
<li><a  href="../f02/index.html">2. hét: logika, sorozatok, tömbök</a>
<li><a  href="../f03/index.html">3. hét: függvények, struktúrák</a>
<li><a  href="../f04/index.html">4. hét: pointerek, sztringek</a>
<li><a  href="../f05/index.html">5. hét: rendezések, rekurzió</a>
<li><a  href="../f06/index.html">6. hét: számábrázolás, bitek</a>
<li><a  href="../f07/index.html">7. hét: dinamikus memóriakezelés</a>
<li><a  href="../f08/index.html">8. hét: parancssor, fájlkezelés, modulok</a>
<li><a  href="../f10/index.html">10. hét: láncolt listák</a>
<li><a  href="../f11/index.html">11. hét: bináris fák, többszörös indirekció</a>
<li><a  href="../f12/index.html">12. hét: állapotgépek</a>
<li><a  href="../f13/index.html">13. hét: generikus algoritmusok</a>
</ul>

<li><a  href="../nhflista/index.html">Nagy házi lista</a>
</ul>

<li class="almenu "><a>Segédlet</a>
<ul>
<li><a  href="../jegyzet/index.html">Jegyzet és puska</a>
<li><a  href="../fejlesztokornyezet.html">Fejlesztőkörnyezetek</a>
<li><a  href="../stilus/index.html">Kódolási stílus</a>
<li><a  href="../for_vs_while/index.html">For vagy while?</a>
<li class="almenu "><a>Nagy házi</a>
<ul>
<li><a  href="../mintanhf/index.html">Minta nagy házi</a>
<li><a  href="../nhfspecifikacio/index.html">Specifikáció: hogyan?</a>
<li><a  href="../debugmalloc/index.html">Debugmalloc, memóriakezelés</a>
<li><a  href="../fajlkezeles/index.html">Fájlkezelés, mappák</a>
<li><a  href="../megjelenites/index.html">Szöveges és grafikus megjelenítés</a>
<li><a  href="index.html">Scanf problémák</a>
<li><a  href="../scanf_hibakezeles/index.html">Scanf és hibakezelés</a>
<li><a  href="../karakterkodolas/index.html">Karakterkódolások</a>
<li><a  href="../cbtobbmodul/index.html">Több modulos programok</a>
</ul>

<li class="almenu "><a>ZH</a>
<ul>
<li><a  href="../tldr1/index.html">TL;DR I.</a>
<li><a  href="../tldr2/index.html">TL;DR II.</a>
</ul>

</ul>

<li class="almenu "><a>Extrák</a>
<ul>
<li class="almenu "><a>SVG óra galéria</a>
<ul>
<li><a  href="../orak2021/index.html">SVG óra galéria 2021</a>
<li><a  href="../orak2020/index.html">SVG óra galéria 2020</a>
<li><a  href="../orak2019/index.html">SVG óra galéria 2019</a>
<li><a  href="../orak2018/index.html">SVG óra galéria 2018</a>
<li><a  href="../orak2017/index.html">SVG óra galéria 2017</a>
<li><a  href="../orak2016/index.html">SVG óra galéria 2016</a>
<li><a  href="../orak2015/index.html">SVG óra galéria 2015</a>
</ul>

<li class="almenu "><a>NHF galéria</a>
<ul>
<li><a  href="../nhfgaleria2021/index.html">NHF galéria 2021</a>
<li><a  href="../nhfgaleria2020/index.html">NHF galéria 2020</a>
<li><a  href="../nhfgaleria2019/index.html">NHF galéria 2019</a>
<li><a  href="../nhfgaleria2018/index.html">NHF galéria 2018</a>
<li><a  href="../nhfgaleria2017/index.html">NHF galéria 2017</a>
<li><a  href="../nhfgaleria2016/index.html">NHF galéria 2016</a>
<li><a  href="../nhfgaleria2015/index.html">NHF galéria 2015</a>
<li><a  href="../nhfgaleria2014/index.html">NHF galéria 2014</a>
<li><a  href="../nhfgaleria2013/index.html">NHF galéria 2013</a>
<li><a  href="../nhfgaleria2012/index.html">NHF galéria 2012</a>
</ul>

<li class="almenu "><a>Elmélet</a>
<ul>
<li><a  href="../turing/index.html">Mit tud a számítógép?</a>
<li><a  href="../bf/index.html">BF</a>
<li><a  href="../bitturmix/index.html">Bitturmix</a>
<li><a  href="../kifesto/index.html">Zárt terület kifestése</a>
<li><a  href="../labirintus/index.html">Labirintusok</a>
<li><a  href="../qsort/index.html">Gyorsrendezés</a>
<li><a  href="../tripla/index.html">Tripla indirekció</a>
<li><a  href="../generikus/index.html">Generikus lista</a>
</ul>

<li class="almenu "><a>Gyakorlat</a>
<ul>
<li><a  href="../strlcpy/index.html">Kulturált sztringmásoló</a>
<li><a  href="../xor_csere/index.html">XOR csere</a>
<li><a  href="../include/index.html">include</a>
<li><a  href="../inline/index.html">inline</a>
<li><a  href="../internet/index.html">Internet</a>
</ul>

<li class="almenu "><a>Grafika</a>
<ul>
<li><a  href="../sdl/index.html">SDL grafika</a>
<li><a  href="../sdl_telepito/index.html">SDL telepítés</a>
<li><a  href="../fa/index.html">Fák rajzolása</a>
</ul>

<li class="almenu "><a>Nyelvészet</a>
<ul>
<li><a  href="../mondatelemzo/index.html">Mondatelemző</a>
<li><a  href="../kifejezesek/index.html">Kifejezések</a>
<li><a  href="../derivalas/index.html">Deriválás</a>
</ul>

<li><a  href="../advent/index.html">Adventi naptár</a>
</ul>

</ul>
</div>
</div>
</div>
</nav>

<div class="menu-font-size"><div class="menuplaceholder"></div></div>

<main class="doksi">
<div class="shaper">


<section class="slidescreen" data-title="Scanf problémák">
<div class="slide" id="slide_0">

<a id="0" class="namer"></a>


<div class="slidecontent">
  <h1 class="eloadascim">Scanf problémák</h1>
<div class="focim">
<p class="szerzocim"><i class="szerzo"></i> Czirkos Zoltán · <i class="ido"></i> 2019.02.27.</p>
<p class="kivonat">A karakterek és a sorvége jel kezelése a scanf() függvénynél.</p>
</div>

<p>Feladatunk írni egy programot, amelyik kér egy egész számot; utána pedig beolvas
egy sornyi szöveget.

<pre   ><code class="language-c">#include &lt;stdio.h&gt;

int main(void) {
    int i;
    char s[200];
    
    printf(&quot;Szam: &quot;);
    scanf(&quot;%d&quot;, &amp;i);
    printf(&quot;Szoveg: &quot;);
    fgets(s, 200, stdin);
    
    printf(&quot;A szamod: %d, a szoveged: [%s]\n&quot;, i, s);
    
    return 0;
}</code></pre>

<p>Érdemes kipróbálni: a program <em>nem</em> olvassa be a szöveget. Helyette a <code>fgets()</code> híváson látszólag átugrik, de 
igazából üres sort rak <code>s</code>-be. Vagyis egyetlen egy <code>\n</code> újsor karaktert.

<pre class="screenshot">
Szam: 5
Szoveg: A szamod: 5, a szoveged: [
]
</pre>

<p>Vajon miért, és mit lehet tenni, hogy ez ne így legyen?</p>

  
        <nav id="tartalom">
      <h3>Tartalom</h3>
      <ol>              <li><a href="index.html#1" class="">Mi történik?</a>
              <li><a href="index.html#2" class="">Hogyan tovább? – Sor beolvasása</a>
              <li><a href="index.html#3" class="">Ugyanez karakterre</a>
              <li><a href="index.html#4" class="">Fájlkezelésben</a>
            </ol>    </nav>
  </div>

<div class="clear"></div>

</div>
</section>


<section class="slidescreen" data-title="Mi történik?">
<div class="slide" id="slide_1">

<a id="1" class="namer"></a>

<div class="slideheader">
  <h2 class="slidetitle">
    <span class="oldalszam">1</span><span class="oldalszamafter">. </span>    Mi történik?<a class="hlink" href="index.html#1"><i class="hlink"></i></a>
  </h2>
</div>

<div class="slidecontent">
  
<p>
Tegyük fel, hogy beírjuk: 5 &lt;enter&gt; hello &lt;enter&gt;. Ekkor a program a szabványos
bemenetén a következő karaktereket kapja:

<table class="tomb">
    <tr><td>5<td>↵<td>h<td>e<td>l<td>l<td>o<td>↵
</table>

<p>Logikus is: a <code>scanf %d</code> beolvassa az <code>5</code>-ös számot, beírja
<code>i</code>-be. A következő karakternél megáll, mert az az enter. Nem számjegy, ezért nem tartozhat egy
egész számhoz. Így kerül az 5 a változóba, és tér vissza a <code>scanf()</code> függvény 1-gyel.
<em>Ez az enter ott fog maradni a bemeneten.</em> A következő <code>fgets()</code> hívás enterig
olvassa a sort. Mivel az első karakter, amit ez meglát, pont az enter, ezért kerül az a 
sztringbe. A bemeneten egyébként a hello megmarad, ezt mondjuk egy következő <code>fgets()</code>
hívás beolvasná. Vagy ha utána megint egy <code> scanf %d</code> jönne, az meg hibakóddal térne 
vissza.

<div class="csik megjegyzes">
<h3>Ha egy valaki elkezdi...</h3>

<div class="sticky"><img src="../modulz/halalfej.png" style="display: block"></div>

<p>Erre szokták azt javasolni, hogy <code>fflush(stdin)</code>-t kell írni.</p>

Nem, nem kell azt írni. A C szabvány egy olvasásra megnyitott fájlnál az <code>fflush()</code>-tól nem vár el semmit; vagyis a 
szabvány szerint az <code>fflush(stdin)</code> utasítás hatása <em>definiálatlan.</em> Windowson, az MSDN szerint az 
<code>fflush()</code> input streamre „kiüríti a bemeneti puffert”, ami elég érdekesen hangzik, ugyanis nem egyértelmű, honnan 
kellene tudni, hogy meddig tart a bemeneti puffer.</p>

<p>Ez a tévképzet annyira elterjedt, hogy könyvekben is megjelent; és annyira, hogy más operációs rendszereken és 
függvénykönyvtárakon, pl. az újabb Linuxokon is elkezdték leutánozni az <code>fflush()</code> ilyen jellegű funkcionalitását 
&ndash; tisztán kompatibilitási okokból, hogy a rosszul megírt programok működjenek. Azért csak jegyezzük meg: <em>az 
<code>fflush(stdin)</code> a szabvány szerint értelmetlen</em>.</p>

</div>

<p>Hogy lehet akkor javítani a programot? Legegyszerűbben úgy, hogy a <code>scanf %d</code> hívás után beteszünk egy üres 
<code>getchar()</code>-t. Ott kell lennie egy enternek, azt az entert beolvassuk, eldobjuk. A <code>fgets()</code> pedig majd már a 
<code>h</code> betűt látja elsőnek. Érdemes ezt a <code>getchar()</code> hívást közvetlenül a <code>scanf %d</code> után tenni. 
Akkor az a <code>scanf()</code>+<code>getchar()</code> kombó beolvas egy számot, és nem hagy maga után semmit a bemeneten. Nem a 
következő beolvasás leprogramozásánál kell emlékeznünk, hogy az előzőnél még maradt valamit a bemeneten. A javított rész:

<pre   ><code class="language-cbub">printf(&quot;Szam: &quot;);
scanf(&quot;%d&quot;, &amp;i);
getchar();  // !
printf(&quot;Szoveg: &quot;);
fgets(s, 200, stdin);</code></pre>

<pre class="screenshot">
Szam: 5
Szoveg: hello
A szamod: 5, a szoveged: [hello]
</pre>



  
    </div>

<div class="clear"></div>

</div>
</section>


<section class="slidescreen" data-title="Hogyan tovább? – Sor beolvasása">
<div class="slide" id="slide_2">

<a id="2" class="namer"></a>

<div class="slideheader">
  <h2 class="slidetitle">
    <span class="oldalszam">2</span><span class="oldalszamafter">. </span>    Hogyan tovább? – Sor beolvasása<a class="hlink" href="index.html#2"><i class="hlink"></i></a>
  </h2>
</div>

<div class="slidecontent">
  
<p>
Most már akkor fejezzük be, amit elkezdtünk. Mi történik akkor, ha a felhasználó azt írja be, hogy
5 <kbd>szóköz</kbd> <kbd>enter</kbd> hello <kbd>enter</kbd>? A bemeneten ez lesz:

<table class="tomb">
    <tr><td>5<td>␣<td>↵<td>h<td>e<td>l<td>l<td>o<td>↵
</table>

<p>
Vagyis a <code>getchar()</code> hívásunk a szóközt fogja beolvasni, és az előző probléma újból
előáll.

<p>
Pontosan mit is kellene csinálnunk? A bemeneten van egy szám, utána lehetnek egyéb dolgok, amik minket
nem érdekelnek, az enterig; végül pedig egy enter (ami úgyszint nem érdekel bennünket). Nagyon
egyszerű, olvassuk be ezeket is, és dobjuk el.
Egyik megoldás lehet erre, hogy egészen addig olvasunk, amíg entert nem kapunk. Enternek biztosan
lennie kell előbb-utóbb.

<pre   ><code class="language-c">while (getchar() != '\n')
    ; /* üres */</code></pre>

  
    </div>

<div class="clear"></div>

</div>
</section>


<section class="slidescreen" data-title="Ugyanez karakterre">
<div class="slide" id="slide_3">

<a id="3" class="namer"></a>

<div class="slideheader">
  <h2 class="slidetitle">
    <span class="oldalszam">3</span><span class="oldalszamafter">. </span>    Ugyanez karakterre<a class="hlink" href="index.html#3"><i class="hlink"></i></a>
  </h2>
</div>

<div class="slidecontent">
  
<p>A <code>scanf %c</code>-nek van egy érdekes tulajdonsága. Az összes többi konverzió (pl. <code>%d</code>, <code>%s</code> stb.) 
a beolvasott whitespace karaktereket eldobja, csak amikor nem whitespace karaktert talál, akkor kezdi meg a konverziót. Emiatt 
mindegy, ha egy számra várunk, hogy a felhasználó <code>"5"</code>-öt, vagy <code>"␣␣5"</code>-öt ír be. A <code>scanf %c</code> 
viszont nem teszi ezt. Direkt, hogy egy whitespace karaktert is be lehessen vele olvasni.

<p>Írjunk egy programot, amelyik megkérdezi, hogy „igen(i) vagy nem(n)”, és utána kiírja, melyiket választottuk! Ha a <code>scanf 
%c</code>-nek azt írjuk, hogy <code>"␣␣␣i"</code>, akkor a szóközt fogja a <code>c</code>-be tenni, és nem működik rendesen. A 
<code>scanf()</code>-et a formátumsztringjében egy szóköz karakterrel kérhetjük arra, hogy a szokásos whitespace karakterek 
eldobását elvégezze. Szóval a <code>scanf()</code> hívás, amelyik beolvas egy karaktert, de nem zavarja, ha szóköz van előtte:

<pre   ><code class="language-cbub">#include &lt;stdio.h&gt;

int main(void) {
    char c;
    
    printf(&quot;igen(i) vagy nem(n)? &quot;);
    scanf(&quot; %c&quot;, &amp;c); // omg
    switch (c) {
        case 'i': printf(&quot;igen\n&quot;); break;
        case 'n': printf(&quot;nem\n&quot;); break;
        default:  printf(&quot;???\n&quot;); break;
    }
    
    return 0;
}</code></pre>





  
    </div>

<div class="clear"></div>

</div>
</section>


<section class="slidescreen" data-title="Fájlkezelésben">
<div class="slide" id="slide_4">

<a id="4" class="namer"></a>

<div class="slideheader">
  <h2 class="slidetitle">
    <span class="oldalszam">4</span><span class="oldalszamafter">. </span>    Fájlkezelésben<a class="hlink" href="index.html#4"><i class="hlink"></i></a>
  </h2>
</div>

<div class="slidecontent">
  
<p>Fájlok kezelése esetén minden pontosan ugyanúgy történik, mintha billentyűzetről olvasnánk. Tehát a fent bemutatott problémák 
ott is előjöhetnek, és a megoldási módszer is ugyanaz. Nem véletlen, hogy ezek miatt gyakran a szövegfájlokból <a href="../fajlkezeles/index.html">egész sorokat olvasunk be egyszerre</a>, és utána a beolvasott sztringgel dolgozunk tovább. 
Akkor biztosan tudjuk, hogy mennyit haladtunk előre a fájlban. A beolvasott sort pedig egyben látjuk, onnan tudjuk esetleg tovább 
bontani az adatokat egy <code>sscanf()</code> vagy egy <code>strtok()</code> függvénnyel.</p>
  
    </div>

<div class="clear"></div>

</div>
</section>

</div>
</main>

<footer role="contentinfo">
<div class="shaper">
<div class="footer ">
  <a href="../index/index.html"><img src="../modulz/logo.png" class="footerlogo" alt="Logo"></a>
<div>InfoC – Programozás alapjai I.</div>
<div class="csakkepernyon">
            <a href="../index/index.html">főoldal</a>
         ·     <a href="../elerhetoseg/index.html">elérhetőség</a>
         ·     <a href="../elerhetoseg/index.html#licenc">licenc</a>
         ·     <a href="https://www.facebook.com/infoceetbmehu">facebook</a>
    </div>
<div class="csaknyomtatasban">Kérjük, az oldalak kinyomtatása előtt gondolj a környezetre.</div>
BME EET, 2009-2021.</div>
</div>
</footer>

</div>

<nav>
<a id="scrolltotop"></a>
</nav>

</body>

</html>
